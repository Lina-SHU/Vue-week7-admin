(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6da3b03a"],{b4bf:function(e,t,o){"use strict";o.r(t);var c=o("7a23"),a={class:"container py-3"},n=Object(c["createVNode"])("h1",null,"優惠券管理",-1),i={class:"d-flex justify-content-end"},d={class:"table"},l=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",{scope:"col"},"優惠券名稱"),Object(c["createVNode"])("th",{scope:"col"},"折扣數"),Object(c["createVNode"])("th",{scope:"col"},"到期日"),Object(c["createVNode"])("th",{scope:"col"},"是否啟用"),Object(c["createVNode"])("th",{scope:"col"})])],-1);function s(e,t,o,s,r,u){var p=Object(c["resolveComponent"])("loading"),b=Object(c["resolveComponent"])("pagination"),h=Object(c["resolveComponent"])("updateModal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(p,{active:r.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return r.isLoading=e})},null,8,["active"]),Object(c["createVNode"])("div",a,[n,Object(c["createVNode"])("div",i,[Object(c["createVNode"])("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=function(e){return u.updateModal("new")})},"新增優惠券")]),Object(c["createVNode"])("table",d,[l,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(r.couponList,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:e.id},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.title),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.percent)+"%",1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(new Date(1e3*e.due_date).getFullYear())+"/"+Object(c["toDisplayString"])(new Date(1e3*e.due_date).getMonth()+1)+"/"+Object(c["toDisplayString"])(new Date(1e3*e.due_date).getDate()),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.is_enabled?"啟用":"未啟用"),1),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("button",{class:"btn btn-primary me-2",type:"button",onClick:function(t){return u.updateModal("edit",e)}},"編輯",8,["onClick"]),Object(c["createVNode"])("button",{class:"btn btn-outline-danger",type:"button",onClick:function(t){return u.deleteCoupon(e.id)}},"刪除",8,["onClick"])])])})),128))])]),Object(c["createVNode"])(b,{pages:r.pagination,onGetList:u.getCoupon},null,8,["pages","onGetList"]),Object(c["createVNode"])(h,{ref:"updateModal","is-new":r.isNew,"temp-coupon":r.tempCoupon,onGetCoupon:u.getCoupon},null,8,["is-new","temp-coupon","onGetCoupon"])])],64)}o("99af");var r=o("1799"),u={class:"modal fade",id:"modal",ref:"updateModal"},p={class:"modal-dialog"},b={class:"modal-content"},h={class:"modal-header"},m={key:0,class:"modal-title"},O={key:1,class:"modal-title"},j=Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),f={class:"modal-body"},N={class:"mb-3"},g=Object(c["createVNode"])("label",{for:"name",class:"form-label"},[Object(c["createTextVNode"])("優惠券名稱 "),Object(c["createVNode"])("small",{class:"text-danger"},"*必填")],-1),v={class:"mb-3"},V=Object(c["createVNode"])("label",{for:"discount",class:"form-label"},[Object(c["createTextVNode"])("折扣數 "),Object(c["createVNode"])("small",{class:"text-danger"},"*必填")],-1),y={class:"mb-3"},w=Object(c["createVNode"])("label",{for:"code",class:"form-label"},[Object(c["createTextVNode"])("優惠券代碼 "),Object(c["createVNode"])("small",{class:"text-danger"},"*必填")],-1),C={class:"mb-3"},k=Object(c["createVNode"])("label",{for:"due_date",class:"form-label"},[Object(c["createTextVNode"])("到期日 "),Object(c["createVNode"])("small",{class:"text-danger"},"*必填")],-1),x={class:"form-check"},M=Object(c["createVNode"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),D={class:"modal-footer"},L=Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function _(e,t,o,a,n,i){var d=Object(c["resolveComponent"])("loading");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(d,{active:n.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return n.isLoading=e})},null,8,["active"]),Object(c["createVNode"])("div",u,[Object(c["createVNode"])("div",p,[Object(c["createVNode"])("div",b,[Object(c["createVNode"])("div",h,[o.isNew?(Object(c["openBlock"])(),Object(c["createBlock"])("h5",m,"新增優惠券")):(Object(c["openBlock"])(),Object(c["createBlock"])("h5",O,"編輯優惠券")),j]),Object(c["createVNode"])("div",f,[Object(c["createVNode"])("div",N,[g,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[2]||(t[2]=function(e){return n.temp.title=e})},null,512),[[c["vModelText"],n.temp.title]])]),Object(c["createVNode"])("div",v,[V,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"number",class:"form-control",id:"discount","onUpdate:modelValue":t[3]||(t[3]=function(e){return n.temp.percent=e})},null,512),[[c["vModelText"],n.temp.percent,void 0,{number:!0}]])]),Object(c["createVNode"])("div",y,[w,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":t[4]||(t[4]=function(e){return n.temp.code=e})},null,512),[[c["vModelText"],n.temp.code]])]),Object(c["createVNode"])("div",C,[k,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[5]||(t[5]=function(e){return n.date=e})},null,512),[[c["vModelText"],n.date]])]),Object(c["createVNode"])("div",x,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":t[6]||(t[6]=function(e){return n.temp.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[c["vModelCheckbox"],n.temp.is_enabled]]),M])]),Object(c["createVNode"])("div",D,[L,Object(c["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=function(){return i.updateProduct&&i.updateProduct.apply(i,arguments)})},"編輯")])])])],512)],64)}o("fb6a");var B=o("7c2b"),$=o.n(B),S=o("1940"),T=o.n(S),U={data:function(){return{modal:"",temp:[],date:"",isLoading:!1}},emits:["getCoupon"],props:["tempCoupon","isNew"],methods:{openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()},updateProduct:function(){var e=this;if(this.isLoading=!0,!this.temp.title||!this.temp.percent||!this.date||!this.temp.code)return this.isLoading=!1,void T()({text:"必填項目都要填寫唷！",icon:"error",button:!1,timer:1500});if(this.temp.due_date=Math.floor(new Date(this.date)/1e3),this.isNew){var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("linachen","/admin/coupon");this.$http.post(t,{data:this.temp}).then((function(t){t.data.success&&(e.isLoading=!1,T()({text:"新增成功",icon:"success",button:!1,timer:1500}),e.hideModal(),e.$emit("getCoupon"),e.date="")})).catch((function(e){console.log(e)}))}else{var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("linachen","/admin/coupon/").concat(this.temp.id);this.$http.put(o,{data:this.temp}).then((function(t){t.data.success&&(e.isLoading=!1,T()({text:"編輯成功",icon:"success",button:!1,timer:1500}),e.hideModal(),e.$emit("getCoupon"),e.date="")})).catch((function(e){console.log(e)}))}}},mounted:function(){this.modal=new $.a(this.$refs.updateModal,{backdrop:"static"})},watch:{tempCoupon:function(){this.temp=this.tempCoupon,this.isNew||(this.date="".concat(new Date(1e3*this.temp.due_date).getFullYear(),"-").concat(("0"+(new Date(1e3*this.temp.due_date).getMonth()+1)).slice(-2),"-").concat(("0"+new Date(1e3*this.temp.due_date).getDate()).slice(-2)))}}};U.render=_;var F=U,A={data:function(){return{couponList:[],pagination:[],isNew:!0,tempCoupon:[],isLoading:!1}},components:{pagination:r["a"],updateModal:F},methods:{getCoupon:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("linachen","/admin/coupons?page=").concat(t);this.$http.get(o).then((function(t){t.data.success&&(e.isLoading=!1,e.couponList=t.data.coupons,e.pagination=t.data.pagination)})).catch((function(e){console.log(e)}))},updateModal:function(e,t){"edit"===e?(this.isNew=!1,this.tempCoupon=JSON.parse(JSON.stringify(t)),this.$refs.updateModal.openModal()):"new"===e&&(this.isNew=!0,this.tempCoupon={},this.$refs.updateModal.openModal())},deleteCoupon:function(e){var t=this;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("linachen","/admin/coupon/").concat(e);this.$http.delete(o).then((function(e){e.data.success&&(t.isLoading=!1,T()({text:"刪除成功",button:!1,timer:1500}),t.getCoupon())})).catch((function(e){console.log(e)}))}},created:function(){this.getCoupon()}};A.render=s;t["default"]=A},fb6a:function(e,t,o){"use strict";var c=o("23e7"),a=o("861d"),n=o("e8b5"),i=o("23cb"),d=o("50c4"),l=o("fc6a"),s=o("8418"),r=o("b622"),u=o("1dde"),p=u("slice"),b=r("species"),h=[].slice,m=Math.max;c({target:"Array",proto:!0,forced:!p},{slice:function(e,t){var o,c,r,u=l(this),p=d(u.length),O=i(e,p),j=i(void 0===t?p:t,p);if(n(u)&&(o=u.constructor,"function"!=typeof o||o!==Array&&!n(o.prototype)?a(o)&&(o=o[b],null===o&&(o=void 0)):o=void 0,o===Array||void 0===o))return h.call(u,O,j);for(c=new(void 0===o?Array:o)(m(j-O,0)),r=0;O<j;O++,r++)O in u&&s(c,r,u[O]);return c.length=r,c}})}}]);
//# sourceMappingURL=chunk-6da3b03a.d8a5f5b5.js.map